import telebot
from telebot import types
from random import *


dictionary = ['Жидомор', 'Иерусалимская слеза', 'Канапе','Комиссия','Косушка','Баргузин','Желтый билет',
'Жид', 'Полба', 'Сыть', 'Матица','Мир','Тарап','Требище','Тымьям','Зареть','Зой','Зень','Экипажество', 'Янычары', 'Майорат','Мечтап','Мортира','Навтика', 'Дидивин',
'Дикирий', 'Доля', 'Думные люди','Дьяк','Жеребий', 'Журфикс', 'Зазирать', 'Золотник', 'Изветник','Ифика','Канон','Войт']

rightMeaning = ['Скупец, скряга', 'Водка', 'Небольшой диван с приподнятым изголовьем',
'Поручение; возня, хлопоты, заботы','Полбутылки водки','Северо-восточный ветер на Байкале','В старой России - особый, желтого цвета, паспорт проституток',
'Клякса', 'особый сорт пшеницы', 'еда, пища', 'средняя потолочная балка','крестьянская община',
'порывистый ветер','площадка доля волхования','чебрец','гореть ярким пламенем','вопль','земля',
'оснащение кораблей', 'армейское сословие в Турции', 'порядок наследования земли старшим в семье или в роду',
'топографическая карта','пушка для навесной стрельбы','навигация', 'ученик',
'двусвещие, двойной подсвечник', 'мера веса, 44,43 мг', 'члены боярской думы',
'служитель приказа','пай, земельный надел', 'званый прием', 'осуждать', 
'мера веса, около 4,3 г', 'осведомитель; соглядатай','этика','вид церковного песнопения',
'городской голова или сельский староста в Польше']

answers = ['выдающаяся хрящевая часть гортани', 'Полдень, время завтрака или раннего обеда', 'В средние века - часть обряда посвящения в рыцари',
'Термин средневековой схоластики', 'Бесцеремонное, фамильярное обращение', 'Сад, модный в XVIII в. в Англии', 'Взятка', 'Металлическая сетка, прикрепляемая к шлему, для прикрытия лица, плеч, груди',
'Бесприданница', 'Поцелуй', 'Ассигнация достоинством в 25 рублей','Женщина, живущая в монастыре, но не постриженная в монашество',
'В скандинавской мифологии - воин, обладавший сверхчеловеческой силой', 'Голень','Маленький китайский наклонный бильярд', 'Буддийский жрец в Японии и Китае',
'Пустой, дрянной человек','Извилины, кривы или ломаные линии, вычурный узор','Свободное от занятий время, каникулы',
'Беглый или отбывший наказание каторжник', 'Девы, умершие невестами, женские духи', 'Спинная струна (хорда) красной рыбы, употребляемая в пищу',
'Плетеный шнурок или тесьма', 'Французское кушанье из холодной фаршированной рыбы','Гвельфы - политические сторонники римских пап, боровшихся с императорами Священной Римской империи за власть в Италии',
'Жертвоприношение из ста быков древних греков','Гитара', 'Экипаж', 'Человеческое существо, которое, по представлениям средневековых алхимиков, можно получить искусственно',
'Сшитый из лоскутков меха, который брался из-под горла бобра, соболя или куницы',
'Молодая женщина не очень строгих правил','Монета в полкопейки','24 листа писчей бумаги','Турецкая длиннополая одежда с пуговицами на груди и узкими рукавами',
'Гусарский мундир', 'Доска, на которой сидит пряха, втыкая в нее кудель', 'Египетские девы',
'Цыганки', 'Низкорослый кустарник, малорослый, уродливый лес', 
'Водка, настоянная на пахучих травах', 'Подполье, погреб', 'Популярный в начале XX в. сорт простого мыла', 'Сторублевый кредитный билет с изображением Екатерины II',
'Сандалии с толстой подошвой, которые надевали древнегреческие и древнеримские актеры для увеличения роста',
'Простенькая, наивная девушка, институтка']

bot = telebot.TeleBot(token = '121509342:AAFXx3W76vHz7Y3RTjIMpd0BiCyBD3l37J0')

max_ids = {}

@bot.message_handler(commands=['game'])

def game(message):
    markup = types.ReplyKeyboardMarkup()
    number1 = random.randint(1,37)
    number2 = random.randint(1,20)
    number3 = random.randint(21,40)
    row1 = random.choice(dictionary[number])
    row2 = random.choice(rightMeaning[number])
    row3 = random.choice(answers[number2])
    row4 = random.choice(answers[number3])

    
    markup.row(row2)
    markup.row(row3)
    markup.row(row4)
    
    bot.send_message(chat_id, "Hey, man! We are going to play a small game. Choose here right answer for the word:" + "" + row1, reply_markup=markup)

    utils.set_user_game(message.chat.id)


@bot.message_handler(func=lambda message: True, content_types=['text'])

def check_answer(message):
    answer = utils.get_answer_for_user(message.chat.id)
    if not answer:
        bot.send_message(message.chat.id, 'Чтобы начать игру, выберите команду /game')
    else:
       
        keyboard_hider = types.ReplyKeyboardHide()

        if message.text == answer:
            bot.send_message(message.chat.id, 'Верно!', reply_markup=keyboard_hider)
        else:
            bot.send_message(message.chat.id, 'Увы, Вы не угадали. Попробуйте ещё раз!', reply_markup=keyboard_hider)
        # Удаляем юзера из хранилища (игра закончена)
        utils.finish_user_game(message.chat.id)


if __name__ == '__main__':
    utils.count_rows()
    random.seed()
    bot.polling(none_stop=True)

